Ext.define("Sencha.object.Config",{singleton:true,initialized:false});Ext.define("Sencha.view.Main",{extend:"Ext.tab.Panel",requires:["Ext.TitleBar"],config:{tabBarPosition:"bottom",items:[{title:"localStorage",iconCls:"home",styleHtmlContent:true,items:[{docked:"top",xtype:"titlebar",title:"localStorage Demo"},{xtype:"button",text:"Init Store",handler:function(){if(Sencha.object.Config.initialized==false){var a="";for(var b in localStorage){a+="key: "+b+"value = "+localStorage[b]+";"}Ext.getCmp("output-ls").setHtml("Local Storage: "+a);Sencha.object.Config.offlineStore=Ext.create("Ext.data.Store",{model:"Sencha.model.LocalUser"});Sencha.object.Config.user=Ext.create("Sencha.model.LocalUser",{accountName:"",userName:"",userPassword:""});Sencha.object.Config.initialized=true;Ext.getCmp("output").setHtml("Init Store: start")}else{Ext.getCmp("output").setHtml("Init Store: already initialized")}}},{xtype:"button",text:"Load Store",handler:function(){if(Sencha.object.Config.initialized==true){var b="";for(var c in localStorage){b+="key: "+c+"value = "+localStorage[c]+";"}try{Sencha.object.Config.offlineStore.load();if(Sencha.object.Config.offlineStore.getCount()>0){var a=Sencha.object.Config.offlineStore.getAt(0);Ext.getCmp("output").setHtml("Load Store: accountName: "+a.get("accountName")+", userName: "+a.get("userName"));Ext.getCmp("output-ls").setHtml("Local Storage: "+b)}else{Ext.getCmp("output").setHtml("Load Store: no records in store")}}catch(d){Ext.getCmp("output").setHtml("Load Store: Exception in loading offlinestore")}}else{Ext.getCmp("output").setHtml("Load Store: first initialize")}}},{xtype:"button",text:"Save Store",handler:function(){if(Sencha.object.Config.initialized==true){Sencha.object.Config.user.set("accountName","ls-account");Sencha.object.Config.user.set("userName","ls-user");Sencha.object.Config.user.set("userPassword","ls-password");Sencha.object.Config.offlineStore.removeAll();Sencha.object.Config.offlineStore.add(Sencha.object.Config.user);Sencha.object.Config.offlineStore.sync();var a="";for(var b in localStorage){a+="key: "+b+"value = "+localStorage[b]+";"}Ext.getCmp("output-ls").setHtml("Local Storage: "+a);Ext.getCmp("output").setHtml("Save Store: done")}else{Ext.getCmp("output").setHtml("Save Store: first initialize")}}},{xtype:"button",text:"Save",handler:function(){localStorage.setItem("testing","abc");Ext.getCmp("output").setHtml("Saved.")}},{xtype:"button",text:"Empty",handler:function(){localStorage.removeItem("testing");Ext.getCmp("output").setHtml("Emptied.")}},{xtype:"button",text:"Read",handler:function(){var a=localStorage.getItem("testing");if(a){Ext.getCmp("output").setHtml("Exists! and value is:"+a)}else{Ext.getCmp("output").setHtml("Nothing there!")}}},{id:"output-ls",html:""},{id:"output",html:""}]}]}});Ext.define("Sencha.model.LocalUser",{extend:"Ext.data.Model",requires:["Ext.data.identifier.Uuid"],config:{identifier:"uuid",fields:[{name:"id",type:"string"},{name:"accountName",type:"string"},{name:"userName",type:"string"},{name:"userPassword",type:"password"}],proxy:{type:"localstorage",id:"lstest"}}});Ext.application({name:"Sencha",requires:["Ext.MessageBox"],requires:["Sencha.object.Config"],models:["LocalUser"],views:["Main"],icon:{"57":"resources/icons/Icon.png","72":"resources/icons/Icon~ipad.png","114":"resources/icons/Icon@2x.png","144":"resources/icons/Icon~ipad@2x.png"},isIconPrecomposed:true,startupImage:{"320x460":"resources/startup/320x460.jpg","640x920":"resources/startup/640x920.png","768x1004":"resources/startup/768x1004.png","748x1024":"resources/startup/748x1024.png","1536x2008":"resources/startup/1536x2008.png","1496x2048":"resources/startup/1496x2048.png"},launch:function(){Ext.fly("appLoadingIndicator").destroy();Ext.Viewport.add(Ext.create("Sencha.view.Main"))}});